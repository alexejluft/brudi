#!/bin/bash
# Brudi Post-Merge Hook
# Runs automatically after every `git pull` ‚Äî syncs ~/.brudi/ without manual steps.

REPO_ROOT="$(git rev-parse --show-toplevel)"
REPO_SKILLS="$REPO_ROOT/skills/skills"
REPO_ASSETS="$REPO_ROOT/skills/assets"
REPO_TEMPLATES="$REPO_ROOT/skills/templates"
INSTALLED_SKILLS="$HOME/.brudi/skills"
INSTALLED_ASSETS="$HOME/.brudi/assets"
INSTALLED_TEMPLATES="$HOME/.brudi/templates"

echo "üîÑ Brudi: Syncing after pull..."

# ‚îÄ‚îÄ Skills ‚îÄ‚îÄ
if [ -d "$INSTALLED_SKILLS" ]; then
  cp -r "$REPO_SKILLS"/. "$INSTALLED_SKILLS/"
  SKILL_COUNT=$(ls "$INSTALLED_SKILLS" | wc -l | tr -d ' ')
  echo "‚úÖ Skills synced ($SKILL_COUNT skills)"
else
  echo "‚ö†Ô∏è  ~/.brudi/skills/ not found ‚Äî skipping"
fi

# ‚îÄ‚îÄ Assets ‚îÄ‚îÄ
if [ -d "$INSTALLED_ASSETS" ]; then
  cp -r "$REPO_ASSETS"/. "$INSTALLED_ASSETS/"
  echo "‚úÖ Assets synced"
else
  echo "‚ö†Ô∏è  ~/.brudi/assets/ not found ‚Äî skipping"
fi

# ‚îÄ‚îÄ Templates ‚îÄ‚îÄ
if [ -d "$INSTALLED_TEMPLATES" ]; then
  cp -r "$REPO_TEMPLATES"/. "$INSTALLED_TEMPLATES/"
  echo "‚úÖ Templates synced"
else
  echo "‚ö†Ô∏è  ~/.brudi/templates/ not found ‚Äî skipping"
fi

echo "‚úÖ Brudi up to date."
