---
import Layout from '../layouts/Layout.astro';
---

<Layout title="brudi.dev ‚Äî React Hooks">
  <main class="max-w-4xl mx-auto px-6 py-16">
    
    <header class="mb-16">
      <a href="/" class="text-zinc-500 hover:text-zinc-300 text-sm mb-4 inline-block">‚Üê Zur√ºck</a>
      <h1 class="text-4xl font-bold mb-2 page-title">
        React <span class="text-blue-500">Hooks</span>
      </h1>
      <p class="text-zinc-400">
        Custom Hooks & Patterns f√ºr sauberen React Code.
      </p>
    </header>

    <!-- Rules -->
    <section class="mb-16 p-6 bg-yellow-500/10 border border-yellow-500/30 rounded-xl">
      <h2 class="text-yellow-400 font-medium mb-3">‚ö†Ô∏è Die 2 Regeln</h2>
      <ol class="space-y-2 text-zinc-300">
        <li><strong>1.</strong> Hooks nur auf Top-Level aufrufen ‚Äî nie in Loops, Conditions, nested Functions</li>
        <li><strong>2.</strong> Hooks nur aus React Functions aufrufen ‚Äî Components oder andere Hooks</li>
      </ol>
    </section>

    <!-- useMousePosition -->
    <section class="mb-16">
      <h2 class="text-2xl font-semibold mb-6 text-zinc-200">
        Custom Hook Beispiele
      </h2>

      <article class="mb-8 bg-zinc-900/50 border border-zinc-800 rounded-xl p-6">
        <h3 class="text-lg font-medium mb-2 text-blue-400">useMousePosition</h3>
        <p class="text-zinc-400 text-sm mb-4">
          Trackt die Mausposition ‚Äî Event Listener Setup & Cleanup Pattern.
        </p>
        <pre class="text-sm overflow-x-auto"><code class="text-zinc-300">function useMousePosition() {'{'}
  const [position, setPosition] = useState({'{'} x: 0, y: 0 {'}'});

  useEffect(() => {'{'}
    const handler = (e) => {'{'}
      setPosition({'{'} x: e.clientX, y: e.clientY {'}'});
    {'}'};
    
    window.addEventListener('mousemove', handler);
    return () => window.removeEventListener('mousemove', handler);
  {'}'}, []);

  return position;
{'}'}

// Usage
const {'{'} x, y {'}'} = useMousePosition();</code></pre>
      </article>

      <!-- useFetch -->
      <article class="mb-8 bg-zinc-900/50 border border-zinc-800 rounded-xl p-6">
        <h3 class="text-lg font-medium mb-2 text-green-400">useFetch</h3>
        <p class="text-zinc-400 text-sm mb-4">
          Data Fetching mit Loading, Error & Cleanup.
        </p>
        <pre class="text-sm overflow-x-auto"><code class="text-zinc-300">function useFetch&lt;T&gt;(url: string) {'{'}
  const [data, setData] = useState&lt;T | null&gt;(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState&lt;string | null&gt;(null);

  useEffect(() => {'{'}
    let isMounted = true;  // Prevent state update on unmount
    
    async function fetchData() {'{'}
      try {'{'}
        const res = await fetch(url);
        if (!res.ok) throw new Error(`HTTP ${'{'}res.status{'}'}`);
        const json = await res.json();
        if (isMounted) {'{'}
          setData(json);
          setLoading(false);
        {'}'}
      {'}'} catch (err) {'{'}
        if (isMounted) {'{'}
          setError(err.message);
          setLoading(false);
        {'}'}
      {'}'}
    {'}'}
    
    fetchData();
    return () => {'{'} isMounted = false; {'}'};
  {'}'}, [url]);

  return {'{'} data, loading, error {'}'};
{'}'}

// Usage
const {'{'} data, loading, error {'}'} = useFetch('/api/users');</code></pre>
      </article>

      <!-- useLocalStorage -->
      <article class="mb-8 bg-zinc-900/50 border border-zinc-800 rounded-xl p-6">
        <h3 class="text-lg font-medium mb-2 text-purple-400">useLocalStorage</h3>
        <p class="text-zinc-400 text-sm mb-4">
          State persistieren ‚Äî synct automatisch mit localStorage.
        </p>
        <pre class="text-sm overflow-x-auto"><code class="text-zinc-300">function useLocalStorage&lt;T&gt;(key: string, initial: T) {'{'}
  const [value, setValue] = useState&lt;T&gt;(() => {'{'}
    if (typeof window === 'undefined') return initial;
    try {'{'}
      const item = localStorage.getItem(key);
      return item ? JSON.parse(item) : initial;
    {'}'} catch {'{'}
      return initial;
    {'}'}
  {'}'});

  useEffect(() => {'{'}
    localStorage.setItem(key, JSON.stringify(value));
  {'}'}, [key, value]);

  return [value, setValue] as const;
{'}'}

// Usage
const [theme, setTheme] = useLocalStorage('theme', 'dark');</code></pre>
      </article>

      <!-- useDebounce -->
      <article class="mb-8 bg-zinc-900/50 border border-zinc-800 rounded-xl p-6">
        <h3 class="text-lg font-medium mb-2 text-orange-400">useDebounce</h3>
        <p class="text-zinc-400 text-sm mb-4">
          Verz√∂gert einen Wert ‚Äî perfekt f√ºr Search Inputs.
        </p>
        <pre class="text-sm overflow-x-auto"><code class="text-zinc-300">function useDebounce&lt;T&gt;(value: T, delay: number) {'{'}
  const [debouncedValue, setDebouncedValue] = useState(value);

  useEffect(() => {'{'}
    const timer = setTimeout(() => {'{'}
      setDebouncedValue(value);
    {'}'}, delay);

    return () => clearTimeout(timer);
  {'}'}, [value, delay]);

  return debouncedValue;
{'}'}

// Usage
const [search, setSearch] = useState('');
const debouncedSearch = useDebounce(search, 300);

useEffect(() => {'{'}
  // API call nur wenn User aufh√∂rt zu tippen
  fetchResults(debouncedSearch);
{'}'}, [debouncedSearch]);</code></pre>
      </article>

      <!-- useOnClickOutside -->
      <article class="mb-8 bg-zinc-900/50 border border-zinc-800 rounded-xl p-6">
        <h3 class="text-lg font-medium mb-2 text-pink-400">useOnClickOutside</h3>
        <p class="text-zinc-400 text-sm mb-4">
          Callback wenn au√üerhalb eines Elements geklickt wird ‚Äî f√ºr Dropdowns, Modals.
        </p>
        <pre class="text-sm overflow-x-auto"><code class="text-zinc-300">function useOnClickOutside(
  ref: RefObject&lt;HTMLElement&gt;, 
  handler: () => void
) {'{'}
  useEffect(() => {'{'}
    const listener = (e: MouseEvent) => {'{'}
      if (!ref.current || ref.current.contains(e.target as Node)) {'{'}
        return;
      {'}'}
      handler();
    {'}'};

    document.addEventListener('mousedown', listener);
    return () => document.removeEventListener('mousedown', listener);
  {'}'}, [ref, handler]);
{'}'}

// Usage
const dropdownRef = useRef(null);
useOnClickOutside(dropdownRef, () => setIsOpen(false));</code></pre>
      </article>
    </section>

    <!-- Best Practices -->
    <section class="mb-16">
      <h2 class="text-2xl font-semibold mb-6 text-zinc-200">Best Practices</h2>
      
      <div class="space-y-3">
        <div class="flex gap-3 text-zinc-300">
          <span class="text-green-400">‚úÖ</span>
          <span>Hooks mit "use" prefixen ‚Äî useWhatever</span>
        </div>
        <div class="flex gap-3 text-zinc-300">
          <span class="text-green-400">‚úÖ</span>
          <span>Cleanup in useEffect ‚Äî Memory Leaks vermeiden</span>
        </div>
        <div class="flex gap-3 text-zinc-300">
          <span class="text-green-400">‚úÖ</span>
          <span>isMounted Pattern ‚Äî State Updates nach Unmount verhindern</span>
        </div>
        <div class="flex gap-3 text-zinc-300">
          <span class="text-green-400">‚úÖ</span>
          <span>useCallback f√ºr Handler ‚Äî Unn√∂tige Re-Renders vermeiden</span>
        </div>
        <div class="flex gap-3 text-zinc-300">
          <span class="text-red-400">‚ùå</span>
          <span>Premature Abstraction ‚Äî Hooks nur wenn sie echten Mehrwert bieten</span>
        </div>
      </div>
    </section>

    <!-- Key Insight -->
    <section class="mb-16 p-6 bg-blue-500/10 border border-blue-500/30 rounded-xl">
      <h3 class="text-blue-400 font-medium mb-2">üí° Key Insight</h3>
      <p class="text-zinc-300">
        Custom Hooks teilen <strong>Logik</strong>, nicht <strong>State</strong>. 
        Jede Komponente die einen Hook aufruft bekommt ihre eigene isolierte State-Kopie.
      </p>
    </section>

    <nav class="flex gap-4 pt-8 border-t border-zinc-800">
      <a href="/typescript" class="text-blue-400 hover:text-blue-300">‚Üê TypeScript</a>
      <a href="/" class="text-blue-400 hover:text-blue-300 ml-auto">Home ‚Üí</a>
    </nav>

  </main>
</Layout>
